<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TakibiEsasi Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .sidebar-item.active { background-color: #3b82f6; color: white; }
        .sidebar-item:hover:not(.active) { background-color: #f3f4f6; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-600 to-purple-700">
        <div class="bg-white p-8 rounded-2xl shadow-2xl w-96">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-balance-scale text-2xl text-white"></i>
                </div>
                <h1 class="text-2xl font-bold text-gray-800">TakibiEsasi</h1>
                <p class="text-gray-500">Admin Panel</p>
            </div>
            <div class="space-y-4">
                <input type="text" id="username" placeholder="Kullanıcı Adı"
                    class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <input type="password" id="password" placeholder="Şifre"
                    class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    onkeypress="if(event.key==='Enter')login()">
                <button onclick="login()"
                    class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-xl hover:opacity-90 transition font-semibold">
                    <i class="fas fa-sign-in-alt mr-2"></i>Giriş Yap
                </button>
            </div>
            <p id="loginError" class="text-red-500 text-center mt-4 hidden"></p>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="hidden flex min-h-screen">
        <!-- Sidebar -->
        <aside class="w-64 bg-white shadow-lg flex flex-col">
            <div class="p-4 border-b">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl flex items-center justify-center">
                        <i class="fas fa-balance-scale text-white"></i>
                    </div>
                    <div>
                        <h1 class="font-bold text-gray-800">TakibiEsasi</h1>
                        <p class="text-xs text-gray-500">Admin Panel</p>
                    </div>
                </div>
            </div>

            <nav class="flex-1 p-4 space-y-1">
                <button onclick="showTab('dashboard')" class="sidebar-item active w-full text-left px-4 py-3 rounded-xl flex items-center space-x-3 transition" data-tab="dashboard">
                    <i class="fas fa-chart-line w-5"></i><span>Dashboard</span>
                </button>
                <button onclick="showTab('licenses')" class="sidebar-item w-full text-left px-4 py-3 rounded-xl flex items-center space-x-3 transition" data-tab="licenses">
                    <i class="fas fa-key w-5"></i><span>Lisanslar</span>
                </button>
                <button onclick="showTab('releases')" class="sidebar-item w-full text-left px-4 py-3 rounded-xl flex items-center space-x-3 transition" data-tab="releases">
                    <i class="fas fa-box w-5"></i><span>Sürümler</span>
                </button>
                <button onclick="showTab('upload')" class="sidebar-item w-full text-left px-4 py-3 rounded-xl flex items-center space-x-3 transition" data-tab="upload">
                    <i class="fas fa-upload w-5"></i><span>Dosya Yükle</span>
                </button>

                <div class="pt-4 mt-4 border-t">
                    <p class="px-4 text-xs font-semibold text-gray-400 uppercase mb-2">Site Yönetimi</p>
                </div>

                <button onclick="showTab('settings')" class="sidebar-item w-full text-left px-4 py-3 rounded-xl flex items-center space-x-3 transition" data-tab="settings">
                    <i class="fas fa-cog w-5"></i><span>Site Ayarları</span>
                </button>
                <button onclick="showTab('pricing')" class="sidebar-item w-full text-left px-4 py-3 rounded-xl flex items-center space-x-3 transition" data-tab="pricing">
                    <i class="fas fa-tags w-5"></i><span>Fiyatlandırma</span>
                </button>
                <button onclick="showTab('testimonials')" class="sidebar-item w-full text-left px-4 py-3 rounded-xl flex items-center space-x-3 transition" data-tab="testimonials">
                    <i class="fas fa-quote-right w-5"></i><span>Yorumlar</span>
                </button>
                <button onclick="showTab('faq')" class="sidebar-item w-full text-left px-4 py-3 rounded-xl flex items-center space-x-3 transition" data-tab="faq">
                    <i class="fas fa-question-circle w-5"></i><span>SSS</span>
                </button>
                <button onclick="showTab('announcements')" class="sidebar-item w-full text-left px-4 py-3 rounded-xl flex items-center space-x-3 transition" data-tab="announcements">
                    <i class="fas fa-bullhorn w-5"></i><span>Duyurular</span>
                </button>
                <button onclick="showTab('messages')" class="sidebar-item w-full text-left px-4 py-3 rounded-xl flex items-center space-x-3 transition" data-tab="messages">
                    <i class="fas fa-envelope w-5"></i><span>Mesajlar</span>
                    <span id="unreadBadge" class="hidden ml-auto bg-red-500 text-white text-xs px-2 py-0.5 rounded-full">0</span>
                </button>
            </nav>

            <div class="p-4 border-t">
                <button onclick="logout()" class="w-full text-left px-4 py-2 rounded-lg text-red-600 hover:bg-red-50 flex items-center space-x-2">
                    <i class="fas fa-sign-out-alt"></i><span>Çıkış Yap</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 overflow-auto">
            <header class="bg-white shadow-sm px-6 py-4 flex justify-between items-center">
                <h2 id="pageTitle" class="text-xl font-semibold text-gray-800">Dashboard</h2>
                <div class="flex items-center space-x-4">
                    <span class="text-gray-600"><i class="fas fa-user mr-2"></i>Admin</span>
                </div>
            </header>

            <div class="p-6">
                <!-- Dashboard Tab -->
                <div id="dashboard" class="tab-content active">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-green-500">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">Aktif Lisans</p>
                                    <p id="statActive" class="text-3xl font-bold text-gray-800">-</p>
                                </div>
                                <div class="bg-green-100 p-3 rounded-full">
                                    <i class="fas fa-check-circle text-green-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-blue-500">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">Toplam Lisans</p>
                                    <p id="statTotal" class="text-3xl font-bold text-gray-800">-</p>
                                </div>
                                <div class="bg-blue-100 p-3 rounded-full">
                                    <i class="fas fa-users text-blue-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-yellow-500">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">Bugün Aktivasyon</p>
                                    <p id="statToday" class="text-3xl font-bold text-gray-800">-</p>
                                </div>
                                <div class="bg-yellow-100 p-3 rounded-full">
                                    <i class="fas fa-clock text-yellow-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-purple-500">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">Güncel Sürüm</p>
                                    <p id="statVersion" class="text-3xl font-bold text-gray-800">-</p>
                                </div>
                                <div class="bg-purple-100 p-3 rounded-full">
                                    <i class="fas fa-code-branch text-purple-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm">
                        <div class="px-6 py-4 border-b">
                            <h3 class="text-lg font-semibold text-gray-800"><i class="fas fa-history mr-2"></i>Son Aktivasyonlar</h3>
                        </div>
                        <div class="p-6">
                            <table class="w-full">
                                <thead>
                                    <tr class="text-left text-gray-500 text-sm">
                                        <th class="pb-3">Lisans</th>
                                        <th class="pb-3">Makine ID</th>
                                        <th class="pb-3">Tarih</th>
                                        <th class="pb-3">Durum</th>
                                    </tr>
                                </thead>
                                <tbody id="recentActivations">
                                    <tr><td colspan="4" class="text-center text-gray-500 py-4">Yükleniyor...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Licenses Tab -->
                <div id="licenses" class="tab-content">
                    <div class="bg-white rounded-xl shadow-sm">
                        <div class="px-6 py-4 border-b flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-gray-800"><i class="fas fa-key mr-2"></i>Lisans Yönetimi</h3>
                            <button onclick="showCreateLicenseModal()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                                <i class="fas fa-plus mr-2"></i>Yeni Lisans
                            </button>
                        </div>
                        <div class="p-6">
                            <div class="mb-4 flex space-x-4">
                                <input type="text" id="licenseSearch" placeholder="Lisans veya kullanıcı ara..."
                                    class="flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    onkeyup="filterLicenses()">
                                <select id="licenseFilter" class="px-4 py-2 border rounded-lg" onchange="filterLicenses()">
                                    <option value="all">Tümü</option>
                                    <option value="active">Aktif</option>
                                    <option value="inactive">Pasif</option>
                                </select>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="text-left text-gray-500 text-sm border-b">
                                            <th class="pb-3 pr-4">Lisans Anahtarı</th>
                                            <th class="pb-3 pr-4">Kullanıcı Adı</th>
                                            <th class="pb-3 pr-4">Durum</th>
                                            <th class="pb-3 pr-4">Makine ID</th>
                                            <th class="pb-3 pr-4">Transfer</th>
                                            <th class="pb-3 pr-4">Aktivasyon</th>
                                            <th class="pb-3">İşlemler</th>
                                        </tr>
                                    </thead>
                                    <tbody id="licensesList">
                                        <tr><td colspan="7" class="text-center text-gray-500 py-4">Yükleniyor...</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Releases Tab -->
                <div id="releases" class="tab-content">
                    <div class="bg-white rounded-xl shadow-sm">
                        <div class="px-6 py-4 border-b flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-gray-800"><i class="fas fa-box mr-2"></i>Sürüm Yönetimi</h3>
                            <button onclick="showReleaseModal()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                                <i class="fas fa-plus mr-2"></i>Yeni Sürüm
                            </button>
                        </div>
                        <div class="p-6">
                            <div class="mb-6 p-4 bg-blue-50 rounded-xl">
                                <h4 class="font-semibold text-blue-800 mb-2"><i class="fas fa-info-circle mr-2"></i>Güncel Sürüm</h4>
                                <div id="currentRelease" class="text-blue-700">Yükleniyor...</div>
                            </div>
                            <table class="w-full">
                                <thead>
                                    <tr class="text-left text-gray-500 text-sm border-b">
                                        <th class="pb-3 pr-4">Sürüm</th>
                                        <th class="pb-3 pr-4">Tarih</th>
                                        <th class="pb-3 pr-4">Kritik</th>
                                        <th class="pb-3 pr-4">Notlar</th>
                                        <th class="pb-3">İşlemler</th>
                                    </tr>
                                </thead>
                                <tbody id="releasesList">
                                    <tr><td colspan="5" class="text-center text-gray-500 py-4">Yükleniyor...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Upload Tab -->
                <div id="upload" class="tab-content">
                    <div class="bg-white rounded-xl shadow-sm">
                        <div class="px-6 py-4 border-b">
                            <h3 class="text-lg font-semibold text-gray-800"><i class="fas fa-upload mr-2"></i>Dosya Yükle</h3>
                        </div>
                        <div class="p-6">
                            <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center" id="dropZone">
                                <i class="fas fa-cloud-upload-alt text-5xl text-gray-400 mb-4"></i>
                                <p class="text-gray-600 mb-4">Setup dosyasını sürükleyin veya</p>
                                <input type="file" id="fileInput" accept=".exe" class="hidden" onchange="handleFileSelect(event)">
                                <button onclick="document.getElementById('fileInput').click()"
                                    class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                                    <i class="fas fa-folder-open mr-2"></i>Dosya Seç
                                </button>
                                <p class="text-gray-400 text-sm mt-4">Maksimum: 200 MB</p>
                            </div>
                            <div id="uploadProgress" class="hidden mt-4">
                                <div class="flex justify-between mb-2">
                                    <span id="uploadFileName" class="text-gray-700"></span>
                                    <span id="uploadPercent" class="text-gray-500">0%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div id="uploadBar" class="bg-blue-600 h-2 rounded-full transition-all" style="width: 0%"></div>
                                </div>
                            </div>
                            <div id="uploadedFiles" class="mt-6">
                                <h4 class="font-semibold text-gray-800 mb-3">Yüklü Dosyalar</h4>
                                <div id="filesList" class="space-y-2">Yükleniyor...</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Site Settings Tab -->
                <div id="settings" class="tab-content">
                    <div class="bg-white rounded-xl shadow-sm">
                        <div class="px-6 py-4 border-b">
                            <h3 class="text-lg font-semibold text-gray-800"><i class="fas fa-cog mr-2"></i>Site Ayarları</h3>
                        </div>
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Site Başlığı</label>
                                    <input type="text" id="settingSiteTitle" class="w-full px-4 py-2 border rounded-lg" placeholder="TakibiEsasi">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">E-posta</label>
                                    <input type="email" id="settingEmail" class="w-full px-4 py-2 border rounded-lg" placeholder="destek@takibiesasi.com">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Telefon</label>
                                    <input type="text" id="settingPhone" class="w-full px-4 py-2 border rounded-lg" placeholder="+90 212 000 00 00">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Adres</label>
                                    <input type="text" id="settingAddress" class="w-full px-4 py-2 border rounded-lg" placeholder="İstanbul, Türkiye">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Hero Açıklama</label>
                                    <textarea id="settingHeroDesc" rows="3" class="w-full px-4 py-2 border rounded-lg" placeholder="Ana sayfa açıklama metni"></textarea>
                                </div>
                            </div>
                            <div class="mt-6">
                                <button onclick="saveSettings()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                                    <i class="fas fa-save mr-2"></i>Kaydet
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pricing Tab -->
                <div id="pricing" class="tab-content">
                    <div class="bg-white rounded-xl shadow-sm">
                        <div class="px-6 py-4 border-b flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-gray-800"><i class="fas fa-tags mr-2"></i>Fiyatlandırma</h3>
                            <button onclick="showPricingModal()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                                <i class="fas fa-plus mr-2"></i>Yeni Paket
                            </button>
                        </div>
                        <div class="p-6">
                            <div id="pricingList" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <p class="text-gray-500 col-span-3 text-center py-4">Yükleniyor...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Testimonials Tab -->
                <div id="testimonials" class="tab-content">
                    <div class="bg-white rounded-xl shadow-sm">
                        <div class="px-6 py-4 border-b flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-gray-800"><i class="fas fa-quote-right mr-2"></i>Müşteri Yorumları</h3>
                            <button onclick="showTestimonialModal()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                                <i class="fas fa-plus mr-2"></i>Yeni Yorum
                            </button>
                        </div>
                        <div class="p-6">
                            <div id="testimonialsList" class="space-y-4">
                                <p class="text-gray-500 text-center py-4">Yükleniyor...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FAQ Tab -->
                <div id="faq" class="tab-content">
                    <div class="bg-white rounded-xl shadow-sm">
                        <div class="px-6 py-4 border-b flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-gray-800"><i class="fas fa-question-circle mr-2"></i>Sıkça Sorulan Sorular</h3>
                            <button onclick="showFaqModal()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                                <i class="fas fa-plus mr-2"></i>Yeni Soru
                            </button>
                        </div>
                        <div class="p-6">
                            <div id="faqList" class="space-y-3">
                                <p class="text-gray-500 text-center py-4">Yükleniyor...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Announcements Tab -->
                <div id="announcements" class="tab-content">
                    <div class="bg-white rounded-xl shadow-sm">
                        <div class="px-6 py-4 border-b flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-gray-800"><i class="fas fa-bullhorn mr-2"></i>Duyurular</h3>
                            <button onclick="showAnnouncementModal()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                                <i class="fas fa-plus mr-2"></i>Yeni Duyuru
                            </button>
                        </div>
                        <div class="p-6">
                            <div id="announcementsList" class="space-y-3">
                                <p class="text-gray-500 text-center py-4">Yükleniyor...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Messages Tab -->
                <div id="messages" class="tab-content">
                    <div class="bg-white rounded-xl shadow-sm">
                        <div class="px-6 py-4 border-b">
                            <h3 class="text-lg font-semibold text-gray-800"><i class="fas fa-envelope mr-2"></i>İletişim Mesajları</h3>
                        </div>
                        <div class="p-6">
                            <div id="messagesList" class="space-y-4">
                                <p class="text-gray-500 text-center py-4">Yükleniyor...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Create License Modal -->
    <div id="createLicenseModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl shadow-xl w-96 p-6">
            <h3 class="text-lg font-semibold mb-4"><i class="fas fa-key mr-2"></i>Yeni Lisans</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Müşteri Adı</label>
                    <input type="text" id="newLicenseCustomer" class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">E-posta</label>
                    <input type="email" id="newLicenseEmail" class="w-full px-4 py-2 border rounded-lg">
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="hideModal('createLicenseModal')" class="px-4 py-2 border rounded-lg hover:bg-gray-100">İptal</button>
                <button onclick="createLicense()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Oluştur</button>
            </div>
        </div>
    </div>

    <!-- User Name Modal -->
    <div id="userNameModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl shadow-xl w-96 p-6">
            <h3 class="text-lg font-semibold mb-4"><i class="fas fa-user mr-2"></i>Kullanıcı Adı</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Lisans</label>
                    <input type="text" id="userNameLicenseKey" readonly class="w-full px-4 py-2 border rounded-lg bg-gray-100 font-mono text-sm">
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Kullanıcı Adı</label>
                    <input type="text" id="userName" class="w-full px-4 py-2 border rounded-lg" placeholder="Ad Soyad">
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="hideModal('userNameModal')" class="px-4 py-2 border rounded-lg hover:bg-gray-100">İptal</button>
                <button onclick="saveUserName()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Transfer Modal -->
    <div id="transferModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl shadow-xl w-96 p-6">
            <h3 class="text-lg font-semibold mb-4"><i class="fas fa-exchange-alt mr-2"></i>Transfer Düzenle</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Lisans</label>
                    <input type="text" id="transferLicenseKey" readonly class="w-full px-4 py-2 border rounded-lg bg-gray-100 font-mono text-sm">
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Transfer Sayısı</label>
                    <input type="number" id="transferCount" min="0" max="10" class="w-full px-4 py-2 border rounded-lg">
                    <p class="text-xs text-gray-500 mt-1">Maksimum 2 transfer hakkı</p>
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="hideModal('transferModal')" class="px-4 py-2 border rounded-lg hover:bg-gray-100">İptal</button>
                <button onclick="saveTransfer()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Release Modal -->
    <div id="releaseModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl shadow-xl w-[500px] p-6">
            <h3 class="text-lg font-semibold mb-4"><i class="fas fa-box mr-2"></i>Yeni Sürüm</h3>
            <div class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm text-gray-600 mb-1">Sürüm *</label>
                        <input type="text" id="releaseVersion" placeholder="1.0.0" class="w-full px-4 py-2 border rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm text-gray-600 mb-1">Min. Sürüm</label>
                        <input type="text" id="releaseMinVersion" placeholder="1.0.0" class="w-full px-4 py-2 border rounded-lg">
                    </div>
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">İndirme URL *</label>
                    <input type="text" id="releaseUrl" placeholder="https://takibiesasi.com/download/setup.exe" class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Notlar *</label>
                    <textarea id="releaseNotes" rows="3" class="w-full px-4 py-2 border rounded-lg"></textarea>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="releaseCritical" class="mr-2">
                    <label for="releaseCritical" class="text-sm text-gray-600">Kritik güncelleme</label>
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="hideModal('releaseModal')" class="px-4 py-2 border rounded-lg hover:bg-gray-100">İptal</button>
                <button onclick="publishRelease()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">Yayınla</button>
            </div>
        </div>
    </div>

    <!-- Pricing Modal -->
    <div id="pricingModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl shadow-xl w-[500px] p-6">
            <h3 class="text-lg font-semibold mb-4"><i class="fas fa-tags mr-2"></i>Fiyat Paketi</h3>
            <input type="hidden" id="pricingId">
            <div class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm text-gray-600 mb-1">Paket Adı *</label>
                        <input type="text" id="pricingName" placeholder="Başlangıç" class="w-full px-4 py-2 border rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm text-gray-600 mb-1">Fiyat (TL) *</label>
                        <input type="number" id="pricingPrice" placeholder="299" class="w-full px-4 py-2 border rounded-lg">
                    </div>
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Periyot</label>
                    <input type="text" id="pricingPeriod" placeholder="ay" class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Özellikler (satır satır)</label>
                    <textarea id="pricingFeatures" rows="4" class="w-full px-4 py-2 border rounded-lg" placeholder="Sınırsız dava takibi&#10;E-posta desteği&#10;Bulut yedekleme"></textarea>
                </div>
                <div class="flex items-center space-x-4">
                    <label class="flex items-center"><input type="checkbox" id="pricingPopular" class="mr-2">Popüler</label>
                    <label class="flex items-center"><input type="checkbox" id="pricingActive" class="mr-2" checked>Aktif</label>
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="hideModal('pricingModal')" class="px-4 py-2 border rounded-lg hover:bg-gray-100">İptal</button>
                <button onclick="savePricing()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Testimonial Modal -->
    <div id="testimonialModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl shadow-xl w-[500px] p-6">
            <h3 class="text-lg font-semibold mb-4"><i class="fas fa-quote-right mr-2"></i>Müşteri Yorumu</h3>
            <input type="hidden" id="testimonialId">
            <div class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm text-gray-600 mb-1">Ad Soyad *</label>
                        <input type="text" id="testimonialName" class="w-full px-4 py-2 border rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm text-gray-600 mb-1">Ünvan</label>
                        <input type="text" id="testimonialTitle" placeholder="Avukat" class="w-full px-4 py-2 border rounded-lg">
                    </div>
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Şirket</label>
                    <input type="text" id="testimonialCompany" class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Yorum *</label>
                    <textarea id="testimonialContent" rows="3" class="w-full px-4 py-2 border rounded-lg"></textarea>
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Puan (1-5)</label>
                    <input type="number" id="testimonialRating" min="1" max="5" value="5" class="w-full px-4 py-2 border rounded-lg">
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="hideModal('testimonialModal')" class="px-4 py-2 border rounded-lg hover:bg-gray-100">İptal</button>
                <button onclick="saveTestimonial()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- FAQ Modal -->
    <div id="faqModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl shadow-xl w-[500px] p-6">
            <h3 class="text-lg font-semibold mb-4"><i class="fas fa-question-circle mr-2"></i>SSS</h3>
            <input type="hidden" id="faqId">
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Soru *</label>
                    <input type="text" id="faqQuestion" class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Cevap *</label>
                    <textarea id="faqAnswer" rows="4" class="w-full px-4 py-2 border rounded-lg"></textarea>
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Sıra</label>
                    <input type="number" id="faqOrder" value="0" class="w-full px-4 py-2 border rounded-lg">
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="hideModal('faqModal')" class="px-4 py-2 border rounded-lg hover:bg-gray-100">İptal</button>
                <button onclick="saveFaq()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Announcement Modal -->
    <div id="announcementModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl shadow-xl w-[500px] p-6">
            <h3 class="text-lg font-semibold mb-4"><i class="fas fa-bullhorn mr-2"></i>Duyuru</h3>
            <input type="hidden" id="announcementId">
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-600 mb-1">Başlık *</label>
                    <input type="text" id="announcementTitle" class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm text-gray-600 mb-1">İçerik</label>
                    <textarea id="announcementContent" rows="3" class="w-full px-4 py-2 border rounded-lg"></textarea>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="announcementActive" class="mr-2" checked>
                    <label for="announcementActive" class="text-sm text-gray-600">Aktif</label>
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="hideModal('announcementModal')" class="px-4 py-2 border rounded-lg hover:bg-gray-100">İptal</button>
                <button onclick="saveAnnouncement()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Kaydet</button>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = '/api';
        let authToken = localStorage.getItem('adminToken');

        // Utilities
        function hideModal(id) { document.getElementById(id).classList.add('hidden'); }
        function showModal(id) { document.getElementById(id).classList.remove('hidden'); }

        function formatDate(dateStr) {
            if (!dateStr) return '-';
            const d = new Date(dateStr);
            return d.toLocaleDateString('tr-TR') + ' ' + d.toLocaleTimeString('tr-TR', {hour: '2-digit', minute: '2-digit'});
        }

        function formatSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        // Auth
        async function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            try {
                const response = await fetch(`${API_BASE}/admin/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                const data = await response.json();
                if (data.success) {
                    authToken = data.token;
                    localStorage.setItem('adminToken', authToken);
                    showAdminPanel();
                } else {
                    document.getElementById('loginError').textContent = 'Hatalı giriş';
                    document.getElementById('loginError').classList.remove('hidden');
                }
            } catch (e) {
                document.getElementById('loginError').textContent = 'Bağlantı hatası';
                document.getElementById('loginError').classList.remove('hidden');
            }
        }

        function logout() {
            localStorage.removeItem('adminToken');
            authToken = null;
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
        }

        function showAdminPanel() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('adminPanel').classList.remove('hidden');
            loadDashboard();
            loadLicenses();
            loadReleases();
            loadFiles();
            loadSettings();
            loadPricing();
            loadTestimonials();
            loadFaq();
            loadAnnouncements();
            loadMessages();
        }

        // Tab Navigation
        const pageTitles = {
            dashboard: 'Dashboard', licenses: 'Lisanslar', releases: 'Sürümler', upload: 'Dosya Yükle',
            settings: 'Site Ayarları', pricing: 'Fiyatlandırma', testimonials: 'Yorumlar',
            faq: 'SSS', announcements: 'Duyurular', messages: 'Mesajlar'
        };

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.sidebar-item').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
            document.getElementById('pageTitle').textContent = pageTitles[tabId] || tabId;
        }

        // Dashboard
        async function loadDashboard() {
            try {
                const response = await fetch(`${API_BASE}/admin/stats`, { headers: { 'Authorization': `Bearer ${authToken}` } });
                const data = await response.json();
                document.getElementById('statActive').textContent = data.active_licenses || 0;
                document.getElementById('statTotal').textContent = data.total_licenses || 0;
                document.getElementById('statToday').textContent = data.today_activations || 0;
                document.getElementById('statVersion').textContent = data.current_version || '-';

                const tbody = document.getElementById('recentActivations');
                if (data.recent_activations?.length > 0) {
                    tbody.innerHTML = data.recent_activations.map(a => `
                        <tr class="border-b">
                            <td class="py-3 pr-4 font-mono text-sm">${a.license_key.substring(0, 16)}...</td>
                            <td class="py-3 pr-4 font-mono text-xs">${a.machine_id ? a.machine_id.substring(0, 12) + '...' : '-'}</td>
                            <td class="py-3 pr-4 text-sm">${formatDate(a.activated_at)}</td>
                            <td class="py-3"><span class="px-2 py-1 rounded-full text-xs ${a.is_active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">${a.is_active ? 'Aktif' : 'Pasif'}</span></td>
                        </tr>
                    `).join('');
                } else {
                    tbody.innerHTML = '<tr><td colspan="4" class="text-center text-gray-500 py-4">Henüz aktivasyon yok</td></tr>';
                }
            } catch (e) { console.error('Dashboard error:', e); }
        }

        // Licenses
        async function loadLicenses() {
            try {
                const response = await fetch(`${API_BASE}/admin/licenses`, { headers: { 'Authorization': `Bearer ${authToken}` } });
                const data = await response.json();
                const tbody = document.getElementById('licensesList');
                if (data.licenses?.length > 0) {
                    tbody.innerHTML = data.licenses.map(l => `
                        <tr class="border-b license-row" data-active="${l.is_active}" data-key="${l.license_key.toLowerCase()}" data-name="${(l.user_name || '').toLowerCase()}">
                            <td class="py-3 pr-4 font-mono text-sm">${l.license_key}</td>
                            <td class="py-3 pr-4 text-sm">
                                <button onclick="showUserNameModal('${l.license_key}', '${(l.user_name || '').replace(/'/g, "\\'")}')"
                                    class="px-2 py-1 rounded bg-gray-100 hover:bg-gray-200 cursor-pointer text-left min-w-[100px]">
                                    ${l.user_name || '<span class="text-gray-400">-</span>'} <i class="fas fa-edit text-xs text-gray-400 ml-1"></i>
                                </button>
                            </td>
                            <td class="py-3 pr-4">
                                <span class="px-2 py-1 rounded-full text-xs ${l.is_active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                    ${l.is_active ? 'Aktif' : 'Pasif'}
                                </span>
                            </td>
                            <td class="py-3 pr-4 font-mono text-xs">${l.machine_id ? l.machine_id.substring(0, 16) + '...' : '-'}</td>
                            <td class="py-3 pr-4 text-sm">
                                <button onclick="showTransferModal('${l.license_key}', ${l.transfer_count || 0})"
                                    class="px-2 py-1 rounded bg-gray-100 hover:bg-gray-200 cursor-pointer">
                                    ${l.transfer_count || 0}/2 <i class="fas fa-edit text-xs text-gray-400 ml-1"></i>
                                </button>
                            </td>
                            <td class="py-3 pr-4 text-sm">${l.activated_at ? formatDate(l.activated_at) : '-'}</td>
                            <td class="py-3">
                                <button onclick="toggleLicense('${l.license_key}')"
                                    class="text-sm px-2 py-1 rounded ${l.is_active ? 'bg-red-100 text-red-700 hover:bg-red-200' : 'bg-green-100 text-green-700 hover:bg-green-200'}">
                                    ${l.is_active ? 'Kapat' : 'Aç'}
                                </button>
                            </td>
                        </tr>
                    `).join('');
                } else {
                    tbody.innerHTML = '<tr><td colspan="7" class="text-center text-gray-500 py-4">Lisans bulunamadı</td></tr>';
                }
            } catch (e) { console.error('Licenses error:', e); }
        }

        function filterLicenses() {
            const search = document.getElementById('licenseSearch').value.toLowerCase();
            const filter = document.getElementById('licenseFilter').value;
            document.querySelectorAll('.license-row').forEach(row => {
                const key = row.dataset.key;
                const name = row.dataset.name || '';
                const isActive = row.dataset.active === 'true';
                let show = key.includes(search) || name.includes(search);
                if (filter === 'active') show = show && isActive;
                if (filter === 'inactive') show = show && !isActive;
                row.style.display = show ? '' : 'none';
            });
        }

        async function toggleLicense(key) {
            if (!confirm('Lisans durumunu değiştirmek istediğinize emin misiniz?')) return;
            await fetch(`${API_BASE}/admin/license/toggle`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ license_key: key })
            });
            loadLicenses();
            loadDashboard();
        }

        function showCreateLicenseModal() { showModal('createLicenseModal'); }

        async function createLicense() {
            const customer = document.getElementById('newLicenseCustomer').value;
            const email = document.getElementById('newLicenseEmail').value;
            const response = await fetch(`${API_BASE}/admin/license/create`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ customer_name: customer, email: email })
            });
            const data = await response.json();
            hideModal('createLicenseModal');
            loadLicenses();
            loadDashboard();
            alert(`Lisans oluşturuldu:\n\n${data.license_key}`);
        }

        function showUserNameModal(key, name) {
            document.getElementById('userNameLicenseKey').value = key;
            document.getElementById('userName').value = name || '';
            showModal('userNameModal');
        }

        async function saveUserName() {
            const key = document.getElementById('userNameLicenseKey').value;
            const userName = document.getElementById('userName').value.trim();
            await fetch(`${API_BASE}/admin/license/set-username`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ license_key: key, user_name: userName })
            });
            hideModal('userNameModal');
            loadLicenses();
        }

        function showTransferModal(key, count) {
            document.getElementById('transferLicenseKey').value = key;
            document.getElementById('transferCount').value = count;
            showModal('transferModal');
        }

        async function saveTransfer() {
            const key = document.getElementById('transferLicenseKey').value;
            const count = parseInt(document.getElementById('transferCount').value);
            await fetch(`${API_BASE}/admin/license/set-transfer`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ license_key: key, transfer_count: count })
            });
            hideModal('transferModal');
            loadLicenses();
        }

        // Releases
        async function loadReleases() {
            try {
                const response = await fetch(`${API_BASE}/admin/releases`, { headers: { 'Authorization': `Bearer ${authToken}` } });
                const data = await response.json();
                if (data.current) {
                    document.getElementById('currentRelease').innerHTML = `<strong>v${data.current.version}</strong> - ${data.current.release_notes}<br><span class="text-sm">Tarih: ${data.current.release_date}</span>`;
                }
                const tbody = document.getElementById('releasesList');
                if (data.releases?.length > 0) {
                    tbody.innerHTML = data.releases.map(r => `
                        <tr class="border-b">
                            <td class="py-3 pr-4 font-semibold">v${r.version}</td>
                            <td class="py-3 pr-4 text-sm">${r.release_date}</td>
                            <td class="py-3 pr-4"><span class="px-2 py-1 rounded-full text-xs ${r.is_critical ? 'bg-red-100 text-red-800' : 'bg-gray-100'}">${r.is_critical ? 'Kritik' : 'Normal'}</span></td>
                            <td class="py-3 pr-4 text-sm text-gray-600">${r.release_notes}</td>
                            <td class="py-3">
                                <button onclick="setCurrentRelease('${r.version}')" class="text-sm px-2 py-1 rounded bg-blue-100 text-blue-700 hover:bg-blue-200">Aktif Yap</button>
                            </td>
                        </tr>
                    `).join('');
                }
            } catch (e) { console.error('Releases error:', e); }
        }

        function showReleaseModal() { showModal('releaseModal'); }

        async function publishRelease() {
            const version = document.getElementById('releaseVersion').value;
            const url = document.getElementById('releaseUrl').value;
            const notes = document.getElementById('releaseNotes').value;
            const minVersion = document.getElementById('releaseMinVersion').value || version;
            const critical = document.getElementById('releaseCritical').checked;
            if (!version || !url || !notes) { alert('Zorunlu alanları doldurun'); return; }
            await fetch(`${API_BASE}/admin/release/publish`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ version, download_url: url, release_notes: notes, min_version: minVersion, is_critical: critical })
            });
            hideModal('releaseModal');
            loadReleases();
            loadDashboard();
        }

        async function setCurrentRelease(version) {
            if (!confirm(`v${version} sürümünü aktif yapmak istiyor musunuz?`)) return;
            await fetch(`${API_BASE}/admin/release/set-current`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ version })
            });
            loadReleases();
            loadDashboard();
        }

        // Files
        async function loadFiles() {
            try {
                const response = await fetch(`${API_BASE}/admin/files`, { headers: { 'Authorization': `Bearer ${authToken}` } });
                const data = await response.json();
                const container = document.getElementById('filesList');
                if (data.files?.length > 0) {
                    container.innerHTML = data.files.map(f => `
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <i class="fas fa-file-archive text-gray-400 mr-3"></i>
                                <div>
                                    <p class="font-medium">${f.name}</p>
                                    <p class="text-sm text-gray-500">${formatSize(f.size)} - ${f.date}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <button onclick="navigator.clipboard.writeText('${f.url}');alert('URL kopyalandı!')" class="text-blue-600 hover:text-blue-800"><i class="fas fa-copy"></i></button>
                                <button onclick="deleteFile('${f.name}')" class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-500 text-center py-4">Dosya yok</p>';
                }
            } catch (e) { console.error('Files error:', e); }
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) uploadFile(file);
        }

        const dropZone = document.getElementById('dropZone');
        if (dropZone) {
            dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.classList.add('border-blue-500', 'bg-blue-50'); });
            dropZone.addEventListener('dragleave', () => { dropZone.classList.remove('border-blue-500', 'bg-blue-50'); });
            dropZone.addEventListener('drop', (e) => { e.preventDefault(); dropZone.classList.remove('border-blue-500', 'bg-blue-50'); if (e.dataTransfer.files[0]) uploadFile(e.dataTransfer.files[0]); });
        }

        async function uploadFile(file) {
            const progress = document.getElementById('uploadProgress');
            const bar = document.getElementById('uploadBar');
            const percent = document.getElementById('uploadPercent');
            document.getElementById('uploadFileName').textContent = file.name;
            progress.classList.remove('hidden');
            const formData = new FormData();
            formData.append('file', file);
            const xhr = new XMLHttpRequest();
            xhr.open('POST', `${API_BASE}/admin/upload`);
            xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
            xhr.upload.onprogress = (e) => { if (e.lengthComputable) { const p = Math.round((e.loaded / e.total) * 100); bar.style.width = p + '%'; percent.textContent = p + '%'; } };
            xhr.onload = () => { progress.classList.add('hidden'); bar.style.width = '0%'; loadFiles(); if (xhr.status === 200) alert('Yüklendi!'); else alert('Hata!'); };
            xhr.send(formData);
        }

        async function deleteFile(name) {
            if (!confirm(`${name} silinsin mi?`)) return;
            await fetch(`${API_BASE}/admin/file/delete`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ filename: name })
            });
            loadFiles();
        }

        // Settings
        async function loadSettings() {
            try {
                const response = await fetch(`${API_BASE}/site/settings`);
                const data = await response.json();
                document.getElementById('settingSiteTitle').value = data.site_title || '';
                document.getElementById('settingEmail').value = data.contact_email || '';
                document.getElementById('settingPhone').value = data.contact_phone || '';
                document.getElementById('settingAddress').value = data.contact_address || '';
                document.getElementById('settingHeroDesc').value = data.hero_description || '';
            } catch (e) { console.error('Settings error:', e); }
        }

        async function saveSettings() {
            const settings = {
                site_title: document.getElementById('settingSiteTitle').value,
                contact_email: document.getElementById('settingEmail').value,
                contact_phone: document.getElementById('settingPhone').value,
                contact_address: document.getElementById('settingAddress').value,
                hero_description: document.getElementById('settingHeroDesc').value
            };
            await fetch(`${API_BASE}/admin/settings/save`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify(settings)
            });
            alert('Ayarlar kaydedildi');
        }

        // Pricing
        async function loadPricing() {
            try {
                const response = await fetch(`${API_BASE}/pricing`);
                const data = await response.json();
                const container = document.getElementById('pricingList');
                if (data?.length > 0) {
                    container.innerHTML = data.map(p => `
                        <div class="border rounded-xl p-4 ${p.is_popular ? 'border-blue-500 bg-blue-50' : ''}">
                            <div class="flex justify-between items-start mb-2">
                                <h4 class="font-semibold">${p.name}</h4>
                                ${p.is_popular ? '<span class="bg-blue-500 text-white text-xs px-2 py-1 rounded-full">Popüler</span>' : ''}
                            </div>
                            <p class="text-2xl font-bold">${p.price} TL<span class="text-sm font-normal text-gray-500">/${p.period || 'ay'}</span></p>
                            <div class="mt-3 text-sm text-gray-600">${(p.features || '').split('\n').filter(f => f).map(f => `<div>• ${f}</div>`).join('')}</div>
                            <div class="mt-4 flex space-x-2">
                                <button onclick="editPricing(${p.id})" class="text-blue-600 hover:text-blue-800"><i class="fas fa-edit"></i></button>
                                <button onclick="deletePricing(${p.id})" class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-500 col-span-3 text-center py-4">Paket yok</p>';
                }
            } catch (e) { console.error('Pricing error:', e); }
        }

        function showPricingModal() {
            document.getElementById('pricingId').value = '';
            document.getElementById('pricingName').value = '';
            document.getElementById('pricingPrice').value = '';
            document.getElementById('pricingPeriod').value = 'ay';
            document.getElementById('pricingFeatures').value = '';
            document.getElementById('pricingPopular').checked = false;
            document.getElementById('pricingActive').checked = true;
            showModal('pricingModal');
        }

        async function savePricing() {
            const data = {
                id: document.getElementById('pricingId').value || null,
                name: document.getElementById('pricingName').value,
                price: document.getElementById('pricingPrice').value,
                period: document.getElementById('pricingPeriod').value,
                features: document.getElementById('pricingFeatures').value,
                is_popular: document.getElementById('pricingPopular').checked,
                is_active: document.getElementById('pricingActive').checked
            };
            await fetch(`${API_BASE}/admin/pricing/save`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify(data)
            });
            hideModal('pricingModal');
            loadPricing();
        }

        async function deletePricing(id) {
            if (!confirm('Silinsin mi?')) return;
            await fetch(`${API_BASE}/admin/pricing/delete`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ id })
            });
            loadPricing();
        }

        // Testimonials
        async function loadTestimonials() {
            try {
                const response = await fetch(`${API_BASE}/testimonials`);
                const data = await response.json();
                const container = document.getElementById('testimonialsList');
                if (data?.length > 0) {
                    container.innerHTML = data.map(t => `
                        <div class="border rounded-xl p-4">
                            <div class="flex justify-between">
                                <div>
                                    <p class="font-semibold">${t.name}</p>
                                    <p class="text-sm text-gray-500">${t.title || ''} ${t.company ? '- ' + t.company : ''}</p>
                                </div>
                                <div class="text-yellow-500">${'★'.repeat(t.rating || 5)}</div>
                            </div>
                            <p class="mt-2 text-gray-600 italic">"${t.content}"</p>
                            <div class="mt-3 flex space-x-2">
                                <button onclick="editTestimonial(${t.id})" class="text-blue-600"><i class="fas fa-edit"></i></button>
                                <button onclick="deleteTestimonial(${t.id})" class="text-red-600"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-500 text-center py-4">Yorum yok</p>';
                }
            } catch (e) { console.error('Testimonials error:', e); }
        }

        function showTestimonialModal() {
            document.getElementById('testimonialId').value = '';
            document.getElementById('testimonialName').value = '';
            document.getElementById('testimonialTitle').value = '';
            document.getElementById('testimonialCompany').value = '';
            document.getElementById('testimonialContent').value = '';
            document.getElementById('testimonialRating').value = 5;
            showModal('testimonialModal');
        }

        async function saveTestimonial() {
            const data = {
                id: document.getElementById('testimonialId').value || null,
                name: document.getElementById('testimonialName').value,
                title: document.getElementById('testimonialTitle').value,
                company: document.getElementById('testimonialCompany').value,
                content: document.getElementById('testimonialContent').value,
                rating: parseInt(document.getElementById('testimonialRating').value)
            };
            await fetch(`${API_BASE}/admin/testimonials/save`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify(data)
            });
            hideModal('testimonialModal');
            loadTestimonials();
        }

        async function deleteTestimonial(id) {
            if (!confirm('Silinsin mi?')) return;
            await fetch(`${API_BASE}/admin/testimonials/delete`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ id })
            });
            loadTestimonials();
        }

        // FAQ
        async function loadFaq() {
            try {
                const response = await fetch(`${API_BASE}/faq`);
                const data = await response.json();
                const container = document.getElementById('faqList');
                if (data?.length > 0) {
                    container.innerHTML = data.map(f => `
                        <div class="border rounded-lg p-4">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="font-semibold">${f.question}</p>
                                    <p class="mt-1 text-gray-600 text-sm">${f.answer}</p>
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="editFaq(${f.id})" class="text-blue-600"><i class="fas fa-edit"></i></button>
                                    <button onclick="deleteFaq(${f.id})" class="text-red-600"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-500 text-center py-4">Soru yok</p>';
                }
            } catch (e) { console.error('FAQ error:', e); }
        }

        function showFaqModal() {
            document.getElementById('faqId').value = '';
            document.getElementById('faqQuestion').value = '';
            document.getElementById('faqAnswer').value = '';
            document.getElementById('faqOrder').value = 0;
            showModal('faqModal');
        }

        async function saveFaq() {
            const data = {
                id: document.getElementById('faqId').value || null,
                question: document.getElementById('faqQuestion').value,
                answer: document.getElementById('faqAnswer').value,
                sort_order: parseInt(document.getElementById('faqOrder').value)
            };
            await fetch(`${API_BASE}/admin/faq/save`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify(data)
            });
            hideModal('faqModal');
            loadFaq();
        }

        async function deleteFaq(id) {
            if (!confirm('Silinsin mi?')) return;
            await fetch(`${API_BASE}/admin/faq/delete`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ id })
            });
            loadFaq();
        }

        // Announcements
        async function loadAnnouncements() {
            try {
                const response = await fetch(`${API_BASE}/announcements`);
                const data = await response.json();
                const container = document.getElementById('announcementsList');
                if (data?.length > 0) {
                    container.innerHTML = data.map(a => `
                        <div class="border rounded-lg p-4 ${a.is_active ? 'border-green-300 bg-green-50' : ''}">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="font-semibold">${a.title}</p>
                                    <p class="text-sm text-gray-600">${a.content || ''}</p>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs ${a.is_active ? 'text-green-600' : 'text-gray-400'}">${a.is_active ? 'Aktif' : 'Pasif'}</span>
                                    <button onclick="editAnnouncement(${a.id})" class="text-blue-600"><i class="fas fa-edit"></i></button>
                                    <button onclick="deleteAnnouncement(${a.id})" class="text-red-600"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-500 text-center py-4">Duyuru yok</p>';
                }
            } catch (e) { console.error('Announcements error:', e); }
        }

        function showAnnouncementModal() {
            document.getElementById('announcementId').value = '';
            document.getElementById('announcementTitle').value = '';
            document.getElementById('announcementContent').value = '';
            document.getElementById('announcementActive').checked = true;
            showModal('announcementModal');
        }

        async function saveAnnouncement() {
            const data = {
                id: document.getElementById('announcementId').value || null,
                title: document.getElementById('announcementTitle').value,
                content: document.getElementById('announcementContent').value,
                is_active: document.getElementById('announcementActive').checked
            };
            await fetch(`${API_BASE}/admin/announcements/save`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify(data)
            });
            hideModal('announcementModal');
            loadAnnouncements();
        }

        async function deleteAnnouncement(id) {
            if (!confirm('Silinsin mi?')) return;
            await fetch(`${API_BASE}/admin/announcements/delete`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ id })
            });
            loadAnnouncements();
        }

        // Messages
        async function loadMessages() {
            try {
                const response = await fetch(`${API_BASE}/admin/messages`, { headers: { 'Authorization': `Bearer ${authToken}` } });
                const data = await response.json();
                const container = document.getElementById('messagesList');
                const unreadCount = data.filter(m => !m.is_read).length;
                document.getElementById('unreadBadge').textContent = unreadCount;
                document.getElementById('unreadBadge').classList.toggle('hidden', unreadCount === 0);

                if (data?.length > 0) {
                    container.innerHTML = data.map(m => `
                        <div class="border rounded-lg p-4 ${m.is_read ? '' : 'bg-blue-50 border-blue-200'}">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="font-semibold">${m.name} <span class="font-normal text-gray-500">&lt;${m.email}&gt;</span></p>
                                    <p class="mt-2 text-gray-700">${m.message}</p>
                                    <p class="mt-2 text-xs text-gray-400">${formatDate(m.created_at)}</p>
                                </div>
                                <div class="flex space-x-2">
                                    ${!m.is_read ? `<button onclick="markAsRead(${m.id})" class="text-blue-600" title="Okundu"><i class="fas fa-check"></i></button>` : ''}
                                    <button onclick="deleteMessage(${m.id})" class="text-red-600"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-500 text-center py-4">Mesaj yok</p>';
                }
            } catch (e) { console.error('Messages error:', e); }
        }

        async function markAsRead(id) {
            await fetch(`${API_BASE}/admin/messages/read`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ id })
            });
            loadMessages();
        }

        async function deleteMessage(id) {
            if (!confirm('Silinsin mi?')) return;
            await fetch(`${API_BASE}/admin/messages/delete`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${authToken}` },
                body: JSON.stringify({ id })
            });
            loadMessages();
        }

        // Auto-login
        if (authToken) showAdminPanel();
    </script>
</body>
</html>
